# Виртуальные машины и коммутация
Перед стартом выполнения задания необходимо убедиться, что виртуальные машины (ВМ) настроены в соответствии с заданием.
Для этого открывем их настройки (клик правой кнопкой мыши (ПКМ) по ВМ => Edit settings).

Сверяем с таблицей (она располагается в конце задания) по параметрам: CPU, Memory Hard disk. В примере показан SRV-Win. Такую настройку необходимо произвести на всех ВМ, но со своими параметрами.
![image](https://user-images.githubusercontent.com/95981205/202833200-36eb736f-565e-41c6-a908-12fbd744c3e2.png)

После нам необходимо проверить наличие коммутации и выполнить её (если она не выполнена). Под понятием "Коммутация" подразумевается настройка VLAN в разделе Networking. Если у вас VLAN ID = 0, то требуется переназначить их. 
![image](https://user-images.githubusercontent.com/95981205/202833347-328a0d5e-6c09-4bf1-a034-4929979b9a3d.png)

Для этого нажимаем ПКМ по сети => Edit settings и меняем наш VLAN ID на всех сетях. По итогу должно получится следующее:

![image](https://user-images.githubusercontent.com/95981205/202833433-1c7f56c5-ca9f-400b-8436-16c021c25203.png)

## Настройка хостов и IP адресов ВМ 
В конце задания есть табличка со всеми необходимыми входными данными. Здесь будет рассматриваться способ настройки hostname и IP адреса.

Итак для Linux машин (WEB-L, WEB-R, ISP) нам необходимо подключить диски. Для этого нажимаем ПКМ по ВМ => Edit Settings. В меню настройки нам необходимо развернуть окошко "CD/DVD Drive 1" и выбрать из выпадающего списка "Datastore ISO file".
![image](https://user-images.githubusercontent.com/95981205/202833698-bed40245-1e20-4cea-90cf-a9cf4e8b4dce.png)
После чего откроется меню для выбора ISO файла, они хранятся в папочке "ISO". Переходим в неё, выбираем первый диск и нажимаем Select.
![image](https://user-images.githubusercontent.com/95981205/202833766-f805ee69-8a55-4c77-bf60-981e93ee8e4b.png)

После нам необходимо подключить CD/DVD Drive 1, нажав на кнопку "Connect". Потом нажимаем на кнопку "Save".

![image](https://user-images.githubusercontent.com/95981205/202833793-c247f1d8-9da2-44ee-b4e3-a633ff286c80.png)

Всё, теперь диск физически подключен к ВМ и мы можем приступить к настройке непосредственно на них. Открываем ВМ (в примере используется WEB-L). Логин/пароль по умолчанию root/toor.

Для подключения диска внутри ВМ необходимо ввести команду: apt-cdrom add. Ниже пример ***УСПЕШНОГО*** подключения диска (если у вас не так, то повторите действия, которые описаны выше).

![image](https://user-images.githubusercontent.com/95981205/202834127-2523ad65-6be7-481d-b902-d4b7a65d77cc.png)

После чего необходимо установить ПО для управления сетевыми соединениями для этого вводим команду: apt install -y network-manager. Ниже пример ***УСПЕШНОГО*** выполнения команды.

![image](https://user-images.githubusercontent.com/95981205/202834265-70d1d255-272b-4494-b3ff-abae6ca5efe6.png)

Затем мы заходим в оснастку ПО командой: nmtui. Откроется окно настройки сетевых подключений, нам нужно перейти в раздел ***"Set system hostname"*** (Перемещение внутри интерфейса реализовано стрелочками в правой части клавиатуры).

![image](https://user-images.githubusercontent.com/95981205/202834317-ba571ca2-0f76-423e-9b9e-046d845c220d.png)

После того как навелись на раздел нажимаем ***"Enter"***, стираем прошлое имя устройства и вводим своё (в соответствии с данными из таблицы в конце задания).

![image](https://user-images.githubusercontent.com/95981205/202834347-d42a14cd-e1ac-49ef-b15f-c4e15f3c89bf.png)

Нажимаем кнопку ***"OK"*** после чего заходим в раздел ***"Edit a connection"***. Откроется меню редактирования сетей, здесь необходимо выбрать наш интерфейс (***НА ISP БУДЕТ 3 ИНТЕРФЕЙСА И ПЕРВЫМ БУДЕТ СЧИТАТЬСЯ ИНТЕРФЕЙС ГДЕ В КОНЦЕ СТОИТ ЦИФРА 1***).

![image](https://user-images.githubusercontent.com/95981205/202834410-fbc7ebac-ec55-4bc8-97b6-98be58123f00.png)

Переходим внутрь Wired connection. После необходимо стрелочками дойти до раздела "IPv4", вместо Automatic поставить Manual и открыть подробную настройку кнопкой "Show".

![image](https://user-images.githubusercontent.com/95981205/202834496-dc020e08-58e5-4b30-be7a-70b81f2bedf3.png)

Открются поля для настройки: Addresses, Gateway, DNS servers. Переходим в секцию "Address", нажимаем "add" и указываем IP address (ДАННЫЙ В ТАБЛИЦЕ В КОНЦЕ ЗАДАНИЯ). 

В качестве gateway указывается IP address ***МАРШРУТИЗАТОРА*** этого сектора **(Т.е. для WEB-L шлюзом будет RTR-L, для WEB-R - RTR-R, У ISP НЕТ GATEWAY!!!!!!)**. IP для gateway должен совпадать по подсети с Ip адресом нашей ВМ. 

В качестве DNS сервера на WEB-L и WEB-R указывается IP адрес SRV (**На ISP не должно быть DNS Servers**).

![image](https://user-images.githubusercontent.com/95981205/202835488-48675b81-09ab-4cc1-8707-62e758f8bb3e.png)

Нажимаем "OK", выходим в командную строку и вводим команду перезагрузки "reboot". После перезагрузки сразу будет видно изменённый hostname:

![image](https://user-images.githubusercontent.com/95981205/202835550-12a75920-aa39-4b84-b32e-dd90906b09bd.png)

Для проверки настройки IP адреса вводим команду "ip a" в командную строку. В выводе будет видно интерфейс и назначенный ему IP адрес с маской подсети.

![image](https://user-images.githubusercontent.com/95981205/202835582-617df8c5-826b-40a8-965f-aacb8c18b79f.png)

Остальные ВМ на базе Linux настраиваются аналогичным способом.

Настройка hostname и IP адреса на SRV. 

Перед настройкой данных параметров необходимо отключить Firewall, чтобы наш траффик мог без ограничений попадать на сервер. Для этого нажимаем нажимаем на "Пуск" в нижней левой части экрана и открываем "Windows Security".

![image](https://user-images.githubusercontent.com/95981205/202835745-7d437fe2-80c4-4700-b1bf-0cf5bb83b480.png)

В нем открываем раздел "Firewall & network protection" и переходим в пункт "Advanced settings".

![image](https://user-images.githubusercontent.com/95981205/202835787-3c85f764-46d4-4612-aaeb-fc6398700452.png)
![image](https://user-images.githubusercontent.com/95981205/202835802-76de060e-1217-4e24-80db-85de686a5b9e.png)

Откроется меню расширенных настроек Firewall. Нажимаем ПКМ на "Inbound Rules", дальше "New Rule".

![image](https://user-images.githubusercontent.com/95981205/202835856-cdbd2222-39f9-426e-b232-19b0123dfb6e.png)

Выбираем "Custom" и потом сразу переходим в раздел "Name".

![image](https://user-images.githubusercontent.com/95981205/202835972-b11628d7-7cf1-41c2-8512-bfc0b0191909.png)

Пишем имя "ICMP" и нажимаем "Finish".

![image](https://user-images.githubusercontent.com/95981205/202835958-45e3840a-5728-4a74-b10e-1ac43ff6f7b6.png)

Для настройки SRV нажимаем ПКМ на "Пуск" в нижней левой части экрана и нажимаем на "Run", в открывшееся окно пишем "sconfig" и открываем его.

![image](https://user-images.githubusercontent.com/95981205/202835642-e7dabb2a-9850-489c-a9f9-7d7d2801a733.png)
![image](https://user-images.githubusercontent.com/95981205/202835651-ee040086-9de3-4d2b-8900-fc5b3e5dea58.png)




